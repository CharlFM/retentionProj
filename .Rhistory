numvar = F,
autoBin = F)
## ----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
plt <- plotTarget(datIn = finDat %>% mutate(dD_to_travD = (lubridate::mdy(Departure_Date)-lubridate::mdy(Deposit_Date)) %>% as.character() %>% as.numeric()), var_inspect = "dD_to_travD", target = "Retained",
numvar = F,
autoBin = F)
## ----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
finDat <- finDat %>%
mutate(depositToDeparture = (lubridate::mdy(Departure_Date) - lubridate::mdy(Deposit_Date)) %>% as.character() %>% as.numeric()) %>%
select(-c(Deposit_Date, Departure_Date))
## ----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
plt <- plotTarget(datIn = finDat, var_inspect = "Special_Pay", target = "Retained",
numvar = F,
autoBin = F)
## ----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
plt <- plotTarget(datIn = finDat %>% mutate(Special_Pay = ifelse(Special_Pay %in% c("CP", "FR", "SA"), Special_Pay, "other")), var_inspect = "Special_Pay", target = "Retained",
numvar = F,
autoBin = F)
## ----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
finDat <- finDat %>% mutate(Special_Pay = ifelse(Special_Pay %in% c("CP", "FR", "SA"), Special_Pay, "other"))
## ----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
plt <- plotTarget(datIn = finDat, var_inspect = "Tuition", target = "Retained",
numvar = F,
autoBin = F)
## ----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
finDat <- finDat %>% mutate(Tuition = as.numeric(Tuition))
## ----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
plt <- plotTarget(datIn = finDat, var_inspect = "Tuition", target = "Retained",
numvar = T, numVarBreaks = seq(-100, 10000, 1),
autoBin = F)
## ----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
plt <- plotTarget(datIn = finDat, var_inspect = "Tuition", target = "Retained",
numvar = T,
autoBin = F)
## ----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
plt <- plotTarget(datIn = finDat %>% mutate(avePrice = as.numeric(SPR_Group_Revenue)/Total_Pax), var_inspect = "avePrice", target = "Retained",
numvar = T,
autoBin = F)
## ----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
finDat <- finDat %>% mutate(avePrice = as.numeric(SPR_Group_Revenue)/Total_Pax)
## ----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
plt <- plotTarget(datIn = finDat, var_inspect = "FRP_Active", target = "Retained",
numvar = F,
autoBin = F)
## ----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
finDat <- finDat %>% mutate(FRP_Active = as.numeric(FRP_Active))
## ----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
plt <- plotTarget(datIn = finDat, var_inspect = "FRP_Active", target = "Retained",
numvar = T, numVarBreaks = seq(-100, 10000, 1),
autoBin = F)
## ----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
plt <- plotTarget(datIn = finDat, var_inspect = "FRP_Active", target = "Retained",
numvar = T,
autoBin = F)
## ----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
plt <- plotTarget(datIn = finDat, var_inspect = "FRP_Cancelled", target = "Retained",
numvar = F,
autoBin = F)
## ----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
finDat <- finDat %>% mutate(FRP_Cancelled = as.numeric(FRP_Cancelled))
## ----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
plt <- plotTarget(datIn = finDat, var_inspect = "FRP_Cancelled", target = "Retained",
numvar = T, numVarBreaks = seq(-100, 10000, 1),
autoBin = F)
## ----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
plt <- plotTarget(datIn = finDat, var_inspect = "FRP_Cancelled", target = "Retained",
numvar = T,
autoBin = F)
## ----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
plt <- plotTarget(datIn = finDat, var_inspect = "FRP_Take_up_percent_", target = "Retained",
numvar = F,
autoBin = F)
## ----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
finDat <- finDat %>% mutate(FRP_Take_up_percent_ = gsub(FRP_Take_up_percent_, pattern = ",", replacement = ".") %>% as.numeric())
## ----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
plt <- plotTarget(datIn = finDat, var_inspect = "FRP_Take_up_percent_", target = "Retained",
numvar = T, numVarBreaks = c(seq(0, 1.2, 0.01)),
autoBin = F)
## ----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
plt <- plotTarget(datIn = finDat, var_inspect = "FRP_Take_up_percent_", target = "Retained",
numvar = T,
autoBin = F)
## ----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
plt <- plotTarget(datIn = finDat, var_inspect = "EZ_Pay_Take_Up_Rate", target = "Retained",
numvar = F,
autoBin = F)
## ----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
finDat <- finDat %>% mutate(EZ_Pay_Take_Up_Rate = gsub(EZ_Pay_Take_Up_Rate, pattern = ",", replacement = ".") %>% as.numeric())
## ----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
plt <- plotTarget(datIn = finDat, var_inspect = "EZ_Pay_Take_Up_Rate", target = "Retained",
numvar = T, numVarBreaks = c(seq(0, 1.2, 0.01)),
autoBin = F)
## ----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
plt <- plotTarget(datIn = finDat, var_inspect = "EZ_Pay_Take_Up_Rate", target = "Retained",
numvar = T,
autoBin = F)
## ----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
plt <- plotTarget(datIn = finDat, var_inspect = "School_Sponsor", target = "Retained",
numvar = F,
autoBin = F)
## ----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
finDat <- finDat %>% mutate(School_Sponsor = if_else(is.na(School_Sponsor), "0", School_Sponsor))
## ----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
plt <- plotTarget(datIn = finDat, var_inspect = "SPR_Group_Revenue", target = "Retained",
numvar = F,
autoBin = F)
## ----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
finDat <- finDat %>% mutate(SPR_Group_Revenue = as.numeric(SPR_Group_Revenue))
## ----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
plt <- plotTarget(datIn = finDat, var_inspect = "SPR_Group_Revenue", target = "Retained",
numvar = T, numVarBreaks = seq(-100, 10000, 1),
autoBin = F)
## ----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
plt <- plotTarget(datIn = finDat, var_inspect = "SPR_Group_Revenue", target = "Retained",
numvar = T,
autoBin = F)
## ----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
plt <- plotTarget(datIn = finDat, var_inspect = "FPP_to_PAX", target = "Retained",
numvar = F,
autoBin = F)
## ----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
finDat <- finDat %>% mutate(FPP_to_PAX = gsub(FPP_to_PAX, pattern = ",", replacement = ".") %>% as.numeric())
## ----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
plt <- plotTarget(datIn = finDat, var_inspect = "FPP_to_PAX", target = "Retained",
numvar = T, numVarBreaks = c(seq(0, 1, 0.01)),
autoBin = F)
## ----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
plt <- plotTarget(datIn = finDat, var_inspect = "FPP_to_PAX", target = "Retained",
numvar = T,
autoBin = F)
## ----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
((finDat$FPP/finDat$Total_Pax - finDat$FPP_to_PAX)/finDat$FPP_to_PAX) %>% summary()
## ----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
plt <- plotTarget(datIn = finDat %>% mutate(FPP_to_PAX = FPP/Total_Pax - FPP_to_PAX), var_inspect = "FPP_to_PAX", target = "Retained",
numvar = T, numVarBreaks = c(seq(-5, 5, 0.0025)),
autoBin = F)
## ----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
finDat <- finDat %>% mutate(FPP_to_PAX = if_else(is.na(FPP_to_PAX) & Total_Pax > 0 & !is.na(Total_Pax), FPP/Total_Pax, FPP_to_PAX))
## ----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
plt <- plotTarget(datIn = finDat, var_inspect = "Num_of_Non_FPP_PAX", target = "Retained",
numvar = F,
autoBin = F)
## ----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
finDat <- finDat %>% mutate(Num_of_Non_FPP_PAX = as.numeric(Num_of_Non_FPP_PAX))
## ----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
plt <- plotTarget(datIn = finDat, var_inspect = "Num_of_Non_FPP_PAX", target = "Retained",
numvar = T, numVarBreaks = c(seq(0, 100, 1)),
autoBin = F)
## ----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
plt <- plotTarget(datIn = finDat, var_inspect = "Num_of_Non_FPP_PAX", target = "Retained",
numvar = T,
autoBin = F)
## ----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
plt <- plotTarget(datIn = finDat, var_inspect = "pol_min", target = "Retained",
numvar = F,
autoBin = F)
## ----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
finDat <- finDat %>% mutate(pol_min = as.numeric(pol_min),
pol_min = ifelse(is.na(pol_min), 0, pol_min))
## ----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
plt <- plotTarget(datIn = finDat, var_inspect = "pol_min", target = "Retained",
numvar = T, numVarBreaks = c(seq(-100, 100, 0.01)),
autoBin = F)
## ----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
plt <- plotTarget(datIn = finDat, var_inspect = "pol_min", target = "Retained",
numvar = T,
autoBin = F)
## ----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
plt <- plotTarget(datIn = finDat, var_inspect = "pol_mean", target = "Retained",
numvar = F,
autoBin = F)
## ----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
finDat <- finDat %>% mutate(pol_mean = as.numeric(pol_mean),
pol_mean = ifelse(is.na(pol_mean), 0, pol_mean))
## ----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
plt <- plotTarget(datIn = finDat, var_inspect = "pol_mean", target = "Retained",
numvar = T, numVarBreaks = c(seq(-100, 100, 0.01)),
autoBin = F)
## ----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
plt <- plotTarget(datIn = finDat, var_inspect = "pol_mean", target = "Retained",
numvar = T,
autoBin = F)
## ----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
plt <- plotTarget(datIn = finDat, var_inspect = "pol_med", target = "Retained",
numvar = F,
autoBin = F)
## ----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
finDat <- finDat %>% mutate(pol_med = as.numeric(pol_med),
pol_med = ifelse(is.na(pol_med), 0, pol_med))
## ----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
plt <- plotTarget(datIn = finDat, var_inspect = "pol_med", target = "Retained",
numvar = T, numVarBreaks = c(seq(-100, 100, 0.01)),
autoBin = F)
## ----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
plt <- plotTarget(datIn = finDat, var_inspect = "pol_med", target = "Retained",
numvar = T,
autoBin = F)
## ----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
plt <- plotTarget(datIn = finDat, var_inspect = "pol_max", target = "Retained",
numvar = F,
autoBin = F)
## ----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
finDat <- finDat %>% mutate(pol_max = as.numeric(pol_max),
pol_max = ifelse(is.na(pol_max), 0, pol_max))
## ----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
plt <- plotTarget(datIn = finDat, var_inspect = "pol_max", target = "Retained",
numvar = T, numVarBreaks = c(seq(-100, 100, 0.01)),
autoBin = F)
## ----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
plt <- plotTarget(datIn = finDat, var_inspect = "pol_max", target = "Retained",
numvar = T,
autoBin = F)
## ----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
plt <- plotTarget(datIn = finDat, var_inspect = "sub_min", target = "Retained",
numvar = F,
autoBin = F)
## ----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
finDat <- finDat %>% mutate(sub_min = as.numeric(sub_min),
sub_min = ifelse(is.na(sub_min), 0, sub_min))
## ----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
plt <- plotTarget(datIn = finDat, var_inspect = "sub_min", target = "Retained",
numvar = T, numVarBreaks = c(seq(-100, 100, 0.01)),
autoBin = F)
## ----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
plt <- plotTarget(datIn = finDat, var_inspect = "sub_min", target = "Retained",
numvar = T,
autoBin = F)
## ----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
plt <- plotTarget(datIn = finDat, var_inspect = "sub_mean", target = "Retained",
numvar = F,
autoBin = F)
## ----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
finDat <- finDat %>% mutate(sub_mean = as.numeric(sub_mean),
sub_mean = ifelse(is.na(sub_mean), 0, sub_mean))
## ----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
plt <- plotTarget(datIn = finDat, var_inspect = "sub_mean", target = "Retained",
numvar = T, numVarBreaks = c(seq(-100, 100, 0.01)),
autoBin = F)
## ----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
plt <- plotTarget(datIn = finDat, var_inspect = "sub_mean", target = "Retained",
numvar = T,
autoBin = F)
## ----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
plt <- plotTarget(datIn = finDat, var_inspect = "sub_med", target = "Retained",
numvar = F,
autoBin = F)
## ----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
finDat <- finDat %>% mutate(sub_med = as.numeric(sub_med),
sub_med = ifelse(is.na(sub_med), 0, sub_med))
## ----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
plt <- plotTarget(datIn = finDat, var_inspect = "sub_med", target = "Retained",
numvar = T, numVarBreaks = c(seq(-100, 100, 0.01)),
autoBin = F)
## ----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
plt <- plotTarget(datIn = finDat, var_inspect = "sub_med", target = "Retained",
numvar = T,
autoBin = F)
## ----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
plt <- plotTarget(datIn = finDat, var_inspect = "sub_max", target = "Retained",
numvar = F,
autoBin = F)
## ----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
finDat <- finDat %>% mutate(sub_max = as.numeric(sub_max),
sub_max = ifelse(is.na(sub_max), 0, sub_max))
## ----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
plt <- plotTarget(datIn = finDat, var_inspect = "sub_max", target = "Retained",
numvar = T, numVarBreaks = c(seq(-100, 100, 0.01)),
autoBin = F)
## ----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
plt <- plotTarget(datIn = finDat, var_inspect = "sub_max", target = "Retained",
numvar = T,
autoBin = F)
## ----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
plt <- plotTarget(datIn = finDat, var_inspect = "twl_min", target = "Retained",
numvar = F,
autoBin = F)
## ----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
finDat <- finDat %>% mutate(twl_min = as.numeric(twl_min),
twl_min = ifelse(is.na(twl_min), 0, twl_min))
## ----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
plt <- plotTarget(datIn = finDat, var_inspect = "twl_min", target = "Retained",
numvar = T, numVarBreaks = c(seq(-100, 100, 0.01)),
autoBin = F)
## ----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
plt <- plotTarget(datIn = finDat, var_inspect = "twl_min", target = "Retained",
numvar = T,
autoBin = F)
## ----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
plt <- plotTarget(datIn = finDat, var_inspect = "twl_mean", target = "Retained",
numvar = F,
autoBin = F)
## ----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
finDat <- finDat %>% mutate(twl_mean = as.numeric(twl_mean),
twl_mean = ifelse(is.na(twl_mean), 0, twl_mean))
## ----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
plt <- plotTarget(datIn = finDat, var_inspect = "twl_mean", target = "Retained",
numvar = T, numVarBreaks = c(seq(-100, 100, 0.01)),
autoBin = F)
## ----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
plt <- plotTarget(datIn = finDat, var_inspect = "twl_mean", target = "Retained",
numvar = T,
autoBin = F)
## ----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
plt <- plotTarget(datIn = finDat, var_inspect = "twl_med", target = "Retained",
numvar = F,
autoBin = F)
## ----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
finDat <- finDat %>% mutate(twl_med = as.numeric(twl_med),
twl_med = ifelse(is.na(twl_med), 0, twl_med))
## ----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
plt <- plotTarget(datIn = finDat, var_inspect = "twl_med", target = "Retained",
numvar = T, numVarBreaks = c(seq(-100, 100, 0.01)),
autoBin = F)
## ----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
plt <- plotTarget(datIn = finDat, var_inspect = "twl_med", target = "Retained",
numvar = T,
autoBin = F)
## ----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
plt <- plotTarget(datIn = finDat, var_inspect = "twl_max", target = "Retained",
numvar = F,
autoBin = F)
## ----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
finDat <- finDat %>% mutate(twl_max = as.numeric(twl_max),
twl_max = ifelse(is.na(twl_max), 0, twl_max))
## ----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
plt <- plotTarget(datIn = finDat, var_inspect = "twl_max", target = "Retained",
numvar = T, numVarBreaks = c(seq(-100, 150, 0.01)),
autoBin = F)
## ----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
plt <- plotTarget(datIn = finDat, var_inspect = "twl_max", target = "Retained",
numvar = T,
autoBin = F)
## ----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
plt <- plotTarget(datIn = finDat, var_inspect = "numTweets", target = "Retained",
numvar = F,
autoBin = F)
## ----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
finDat <- finDat %>% mutate(numTweets = as.numeric(numTweets),
numTweets = ifelse(is.na(numTweets), 0, numTweets))
## ----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
plt <- plotTarget(datIn = finDat, var_inspect = "numTweets", target = "Retained",
numvar = T, numVarBreaks = c(seq(-100, 100, 0.01)),
autoBin = F)
## ----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
plt <- plotTarget(datIn = finDat, var_inspect = "top_0", target = "Retained",
numvar = F,
autoBin = F)
## ----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
finDat <- finDat %>% mutate(top_0 = as.numeric(top_0),
top_0 = ifelse(is.na(top_0), 0, top_0))
## ----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
plt <- plotTarget(datIn = finDat, var_inspect = "top_1", target = "Retained",
numvar = F,
autoBin = F)
## ----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
finDat <- finDat %>% mutate(top_1 = as.numeric(top_1),
top_1 = ifelse(is.na(top_1), 0, top_1))
## ----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
plt <- plotTarget(datIn = finDat, var_inspect = "top_2", target = "Retained",
numvar = F,
autoBin = F)
## ----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
finDat <- finDat %>% mutate(top_2 = as.numeric(top_2),
top_2 = ifelse(is.na(top_2), 0, top_2))
## ----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
plt <- plotTarget(datIn = finDat, var_inspect = "top_3", target = "Retained",
numvar = F,
autoBin = F)
## ----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
finDat <- finDat %>% mutate(top_3 = as.numeric(top_3),
top_3 = ifelse(is.na(top_3), 0, top_3))
## ----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
plt <- plotTarget(datIn = finDat, var_inspect = "top_4", target = "Retained",
numvar = F,
autoBin = F)
## ----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
finDat <- finDat %>% mutate(top_4 = as.numeric(top_4),
top_4 = ifelse(is.na(top_4), 0, top_4))
## ----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
plt <- plotTarget(datIn = finDat, var_inspect = "top_5", target = "Retained",
numvar = F,
autoBin = F)
## ----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
finDat <- finDat %>% mutate(top_5 = as.numeric(top_5),
top_5 = ifelse(is.na(top_5), 0, top_5))
## ----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
plt <- plotTarget(datIn = finDat, var_inspect = "top_6", target = "Retained",
numvar = F,
autoBin = F)
## ----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
finDat <- finDat %>% mutate(top_6 = as.numeric(top_6),
top_6 = ifelse(is.na(top_6), 0, top_6))
## ----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
plt <- plotTarget(datIn = finDat, var_inspect = "top_7", target = "Retained",
numvar = F,
autoBin = F)
## ----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
finDat <- finDat %>% mutate(top_7 = as.numeric(top_7),
top_7 = ifelse(is.na(top_7), 0, top_7))
## ----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
plt <- plotTarget(datIn = finDat, var_inspect = "top_8", target = "Retained",
numvar = F,
autoBin = F)
## ----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
finDat <- finDat %>% mutate(top_8 = as.numeric(top_8),
top_8 = ifelse(is.na(top_8), 0, top_8))
## ----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
plt <- plotTarget(datIn = finDat, var_inspect = "top_9", target = "Retained",
numvar = F,
autoBin = F)
## ----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
finDat <- finDat %>% mutate(top_9 = as.numeric(top_9),
top_9 = ifelse(is.na(top_9), 0, top_9))
finDF %>% select(Total_Pax, FPP_to_PAX, Tuition, SPR_Group_Revenue) %>%
mutate(
FPP     = Total_Pax * FPP_to_PAX
, non_FPP = Total_Pax * (1-FPP_to_PAX)
, d       = 1
)
finDat %>% select(Total_Pax, FPP_to_PAX, Tuition, SPR_Group_Revenue) %>%
mutate(
FPP     = Total_Pax * FPP_to_PAX
, non_FPP = Total_Pax * (1-FPP_to_PAX)
, d       = 1
)
finDat %>% select(Total_Pax, FPP_to_PAX, Tuition, SPR_Group_Revenue, Num_of_Non_FPP_PAX) %>%
mutate(
FPP       = Total_Pax * FPP_to_PAX
, non_FPP = Total_Pax * (1-FPP_to_PAX)
, d       = 1
)
finDat %>% select(Total_Pax, Tuition, SPR_Group_Revenue, Num_of_Non_FPP_PAX) %>%
mutate(
origPriceTot = Total_Pax * Tuition
, totDiscount  = SPR_Group_Revenue - origPriceTot
, propDiscount = totDiscount/origPriceTot
)
finDat %>% select(Total_Pax, Tuition, SPR_Group_Revenue, Num_of_Non_FPP_PAX) %>%
mutate(
origPriceTot = Total_Pax * Tuition
, totDiscount  = origPriceTot - SPR_Group_Revenue
, propDiscount = totDiscount/origPriceTot
)
finDat %>% select(Total_Pax, Tuition, SPR_Group_Revenue, Num_of_Non_FPP_PAX) %>%
mutate(
totDiscount  = Tuition - SPR_Group_Revenue
, propDiscount = totDiscount/origPriceTot
)
finDat %>% select(Total_Pax, Tuition, SPR_Group_Revenue, Num_of_Non_FPP_PAX) %>%
mutate(
totDiscount  = Tuition - SPR_Group_Revenue
, propDiscount = totDiscount/Tuition
)
finDat %>% select(Total_Pax, Tuition, SPR_Group_Revenue, Num_of_Non_FPP_PAX) %>%
mutate(
totDiscount  = Tuition - SPR_Group_Revenue
, propDiscount = totDiscount/Tuition
) %>%
plotTarget(var_inspect = "propDiscount", target = "Retained",
numvar = T,
autoBin = F)
plotTarget(datIn = finDat %>% select(Total_Pax, Tuition, SPR_Group_Revenue, Num_of_Non_FPP_PAX) %>%
mutate(
totDiscount  = Tuition - SPR_Group_Revenue
, propDiscount = totDiscount/Tuition
), var_inspect = "propDiscount", target = "Retained",
numvar = T,
autoBin = F)
finDat %>%
mutate(
totDiscount  = Tuition - SPR_Group_Revenue
, propDiscount = totDiscount/Tuition
) %>%
plotTarget(var_inspect = "propDiscount", target = "Retained",
numvar = T,
autoBin = F)
finDat %>%
mutate(
totDiscount  = Tuition - SPR_Group_Revenue
, propDiscount = totDiscount/Tuition
) %>%
plotTarget(var_inspect = "totDiscount", target = "Retained",
numvar = T,
autoBin = F)
## ----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
finDat <- finDat %>% mutate(
SPR_Group_Revenue = as.numeric(SPR_Group_Revenue)
, totDiscount       = Tuition - SPR_Group_Revenue
, propDiscount      = totDiscount/Tuition
)
## ----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
finDat <- finDat %>% select(-c(pol_min, pol_max, pol_mean))
## ----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
finDat <- finDat %>% select(-c(sub_min, sub_max, sub_mean))
## ----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
finDat <- finDat %>% select(-c(twl_min, twl_max, twl_mean))
## ----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
finDat <- finDat %>% select(-starts_with("top_"))
## ----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
finDat %>% select(Total_Discount_Pax, Num_of_Non_FPP_PAX, Total_Pax) %>% summary()
## ----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
finDat <- finDat %>% select(-c(Total_Discount_Pax, Num_of_Non_FPP_PAX))
## ----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
highlyCorDescr <- cor(finDat %>% select_if(is.numeric), use = "complete.obs") %>%
as.data.frame() %>%
mutate(var1 = rownames(.)) %>%
tidyr::gather(var2, value, -var1) %>%
arrange(desc(value)) %>%
group_by(value) %>%
filter(row_number()==1, abs(value) < 1, abs(value) > 0.8)
highlyCorDescr
PerformanceAnalytics::chart.Correlation(finDat %>% select(c(highlyCorDescr$var1, highlyCorDescr$var2) %>% unique()), histogram = TRUE)
